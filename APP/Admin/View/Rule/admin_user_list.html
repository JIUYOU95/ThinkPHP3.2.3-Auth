<include file="Public:header" />
<script type="text/javascript">
$(function(){
	$('.nopurview').click(function(){
		alert('不允许锁定id为1的管理员帐号！');
		return false;
	});
	$('.nodel').click(function(){
		alert('不允许删除id为1的管理员帐号！');
		return false;
	});
});
</script>
<ul class="nav nav-tabs">
	<li class="active"><a data-toggle="tab" href="#home">管理员列表</a></li>
	<li><a data-toggle="tab" href="#menu1">添加管理员</a></li>
</ul>

<div class="tab-content">
	<div id="home" class="tab-pane fade in active">
		<table class="table table-striped table-bordered table-hover table-condensed" style="text-align:center;">
			<thead>
			<tr>
				<th>用户名</th>
				<th>昵称</th>
				<th>用户组</th>
				<th>邮箱</th>
				<th>状态</th>
				<th>注册时间</th>
				<th>登录IP</th>
				<th>登录时间</th>
				<th>操作</th>
			</tr>
			</thead>
			<tbody>
			<foreach name="access" item="v">
			<tr>
				<td>{$v['username']}</td>
				<td>{$v['nickname']}</td>
				<td>{$v['title']}</td>
				<td>{$v['email']}</td>
				<td>
					<if condition="$v['status'] eq 1"> 正常
					<elseif condition="$v['status'] eq 3"/> 锁定
					<elseif condition="$v['status'] eq 2"/> 未验证
					</if>
				</td>
				<td>
					<if condition="$v['regtime'] eq 0">
					<else/>{$v['regtime'|date='Y-m-d',###]}
					</if>
				</td>
				<td>{$v['loginip']}</td>
				<td>
					<if condition="$v['logintime'] eq 0">
					<else/>{$v['logintime'|date='Y-m-d',###]}
					</if>
				</td>
				<td>
					<if condition="$v['status'] eq 1"> 
						<a href="{:U('Admin/Rule/lockHandle',array('id'=>$v['id'],'username'=>$v['username'],'lock'=>3))}" class='<if condition="$v['id'] eq 1">nopurview</if>'>锁定</a>
					<elseif condition="$v['status'] eq 3"/>
						<a href="{:U('Admin/Rule/lockHandle',array('id'=>$v['id'],'username'=>$v['username'],'lock'=>1))}">解锁</a>
					<elseif condition="$v['status'] eq 2"/>
						<a href="">验证</a>
					</if>
					| <a href="{:U('Admin/Rule/edit_admin',array('id'=>$v['id']))}">修改权限或密码</a>
					| <a href="{:U('Admin/Rule/delete_admin',array('id'=>$v['id'],'username'=>$v['username']))}" class='<if condition="$v['id'] eq 1">nodel</if>'>删除</a>
				</td>
			</tr>
			</foreach>
			</tbody>
		</table>
	</div>
	<div id="menu1" class="tab-pane fade">
		<form class="form-inline" action="{:U('Admin/Rule/add_admin')}" method="post">
			<table class="table table-striped table-bordered table-hover table-condensed">
				<tr>
					<th>管理组</th>
					<td>
					<foreach name="group" item="v"> 
						<label for="{$v['id']}">{$v['title']}</label>
						<input class="xb-icheck" type="checkbox" name="group_ids[]" value="{$v['id']}" id="{$v['id']}"> &emsp;
					</foreach>
					</td>
				</tr>
				<tr>
					<th>用户名</th>
					<td> <input class="form-control" type="text" name="username"><span class="text-danger">&emsp;登录账号，填写后不可修改</span></td>
				</tr>
				<tr>
					<th>昵称</th>
					<td> <input class="form-control" type="text" name="nickname"><span class="text-danger">&emsp;显示的名称</span></td>
				</tr>
				<tr>
					<th>手机号</th>
					<td> <input class="form-control" type="text" name="phone"></td>
				</tr>
				<tr>
					<th>邮箱</th>
					<td> <input class="form-control" type="text" name="email"></td>
				</tr>
				<tr>
					<th>初始密码</th>
					<td> <input class="form-control" type="password" name="password"></td>
				</tr>
				<tr>
					<th>状态</th>
					<td> 
						<div class="btn-group" data-toggle="buttons">
						    <label class="btn btn-primary active">
						        <input type="radio" name="status" value="1" checked> 允许登录
						    </label>
						    <label class="btn btn-primary">
						        <input type="radio" name="status" value="3"> 禁止登录
						    </label>
						</div>
					</td>
				</tr>
				<tr>
					<th></th>
					<td> <input class="btn btn-success" type="submit" value="添加"></td>
				</tr>
			</table>
		</form>
	</div>
</div>

<include file="Public:footer" />